services:
  builder:
    profiles: ["builder"]
    image: lukstep/raspberry-pi-pico-sdk:latest
    working_dir: /home/dev
    volumes:
      - .:/home/dev
    environment:
      - WS2812
      - CLEAN
      - BUILD_TYPE
      - BIOS2UF2
    command: ["/home/dev/tools/dockerbuild.sh"]
  bios2uf2:
    profiles: ["bios2uf2"]
    image: lukstep/raspberry-pi-pico-sdk:latest
    working_dir: /home/dev
    volumes:
      - .:/home/dev
    command: ["python", "tools/flashbin_to_uf2.py", "--output-dir", "/home/dev/out", "bios.bin", "bios/*.bin"]
  dev:
    image: lukstep/raspberry-pi-pico-sdk:latest
    volumes:
      - .:/home/dev
    command: ["sleep", "infinity"]
